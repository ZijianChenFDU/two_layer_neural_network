PS D:\documents\2023spring\nndl\two_layer_neural_network> & C:/Python311/python.exe d:/documents/2023spring/nndl/two_layer_neural_network/main.py
==== Hyper Parameter Search ======================================================
---- Random Trial 1 --------------------------------------------------------------
 lr = 0.184756, weight decay = 2e-07, hidden layer size = 274
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:14<00:00, 96.34it/s]
 random trial 1: val acc = 0.978333
---- Random Trial 2 --------------------------------------------------------------
 lr = 0.191134, weight decay = 1.14e-05, hidden layer size = 272
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:15<00:00, 95.67it/s]
 random trial 2: val acc = 0.98
---- Random Trial 3 --------------------------------------------------------------
 lr = 0.186649, weight decay = 2e-07, hidden layer size = 207
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:45<00:00, 113.05it/s]
 random trial 3: val acc = 0.978
---- Random Trial 4 --------------------------------------------------------------
 lr = 0.211917, weight decay = 2.8e-06, hidden layer size = 257
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:04<00:00, 101.81it/s] 
 random trial 4: val acc = 0.979333
---- Random Trial 5 --------------------------------------------------------------
 lr = 0.185076, weight decay = 9e-07, hidden layer size = 261
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:03<00:00, 102.37it/s] 
 random trial 5: val acc = 0.980833
---- Random Trial 6 --------------------------------------------------------------
 lr = 0.210362, weight decay = 2.4e-06, hidden layer size = 250
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:53<00:00, 108.15it/s] 
 random trial 6: val acc = 0.97925
---- Random Trial 7 --------------------------------------------------------------
 lr = 0.162185, weight decay = 2e-07, hidden layer size = 287
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:05<00:00, 101.11it/s] 
 random trial 7: val acc = 0.978917
---- Random Trial 8 --------------------------------------------------------------
 lr = 0.197776, weight decay = 3.6e-06, hidden layer size = 267
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:56<00:00, 106.04it/s] 
 random trial 8: val acc = 0.979667
---- Random Trial 9 --------------------------------------------------------------
 lr = 0.155615, weight decay = 6e-07, hidden layer size = 234
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:47<00:00, 111.96it/s] 
 random trial 9: val acc = 0.978583
---- Random Trial 10 --------------------------------------------------------------
 lr = 0.22461, weight decay = 8.64e-05, hidden layer size = 203
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:36<00:00, 119.86it/s] 
 random trial 10: val acc = 0.980083
---- Random Trial 11 --------------------------------------------------------------
 lr = 0.243132, weight decay = 7e-07, hidden layer size = 210
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:38<00:00, 117.94it/s] 
 random trial 11: val acc = 0.979333
---- Random Trial 12 --------------------------------------------------------------
 lr = 0.216186, weight decay = 3e-07, hidden layer size = 244
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:49<00:00, 110.53it/s] 
 random trial 12: val acc = 0.978833
---- Random Trial 13 --------------------------------------------------------------
 lr = 0.223281, weight decay = 1.5e-06, hidden layer size = 252
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:49<00:00, 110.48it/s] 
 random trial 13: val acc = 0.980917
---- Random Trial 14 --------------------------------------------------------------
 lr = 0.210843, weight decay = 5e-07, hidden layer size = 266
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:57<00:00, 105.70it/s] 
 random trial 14: val acc = 0.979583
---- Random Trial 15 --------------------------------------------------------------
 lr = 0.157534, weight decay = 1e-07, hidden layer size = 236
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:48<00:00, 111.55it/s] 
 random trial 15: val acc = 0.978083
---- Random Trial 16 --------------------------------------------------------------
 lr = 0.194193, weight decay = 3.03e-05, hidden layer size = 293
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:02<00:00, 102.80it/s] 
 random trial 16: val acc = 0.979417
---- Random Trial 17 --------------------------------------------------------------
 lr = 0.205195, weight decay = 2.8e-06, hidden layer size = 290
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:02<00:00, 102.83it/s] 
 random trial 17: val acc = 0.979333
---- Random Trial 18 --------------------------------------------------------------
 lr = 0.16568, weight decay = 8e-07, hidden layer size = 219
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:41<00:00, 116.32it/s] 
 random trial 18: val acc = 0.97725
---- Random Trial 19 --------------------------------------------------------------
 lr = 0.154512, weight decay = 7e-07, hidden layer size = 256
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:50<00:00, 109.76it/s] 
 random trial 19: val acc = 0.978333
---- Random Trial 20 --------------------------------------------------------------
 lr = 0.173825, weight decay = 8.5e-06, hidden layer size = 226
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:44<00:00, 113.97it/s] 
 random trial 20: val acc = 0.97825
---- Random Trial 21 --------------------------------------------------------------
 lr = 0.214409, weight decay = 2e-07, hidden layer size = 254
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:50<00:00, 109.68it/s] 
 random trial 21: val acc = 0.97875
---- Random Trial 22 --------------------------------------------------------------
 lr = 0.227342, weight decay = 7.4e-06, hidden layer size = 271
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:56<00:00, 106.21it/s] 
 random trial 22: val acc = 0.978167
---- Random Trial 23 --------------------------------------------------------------
 lr = 0.172213, weight decay = 5e-07, hidden layer size = 210
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:38<00:00, 118.19it/s] 
 random trial 23: val acc = 0.9785
---- Random Trial 24 --------------------------------------------------------------
 lr = 0.207795, weight decay = 4.01e-05, hidden layer size = 242
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:48<00:00, 111.37it/s] 
 random trial 24: val acc = 0.979083
---- Random Trial 25 --------------------------------------------------------------
 lr = 0.15505, weight decay = 7.2e-06, hidden layer size = 208
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:37<00:00, 118.97it/s] 
 random trial 25: val acc = 0.977917
---- Random Trial 26 --------------------------------------------------------------
 lr = 0.183816, weight decay = 3e-07, hidden layer size = 282
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:03<00:00, 102.29it/s] 
 random trial 26: val acc = 0.979833
---- Random Trial 27 --------------------------------------------------------------
 lr = 0.23217, weight decay = 4.93e-05, hidden layer size = 282
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:07<00:00, 99.74it/s] 
 random trial 27: val acc = 0.980833
---- Random Trial 28 --------------------------------------------------------------
 lr = 0.22081, weight decay = 1.07e-05, hidden layer size = 288
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:01<00:00, 103.28it/s] 
 random trial 28: val acc = 0.97975
---- Random Trial 29 --------------------------------------------------------------
 lr = 0.239926, weight decay = 3.7e-05, hidden layer size = 247
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:48<00:00, 111.38it/s] 
 random trial 29: val acc = 0.979833
---- Random Trial 30 --------------------------------------------------------------
 lr = 0.235109, weight decay = 3e-07, hidden layer size = 252
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:48<00:00, 110.96it/s] 
 random trial 30: val acc = 0.978833
---- Random Trial 31 --------------------------------------------------------------
 lr = 0.231094, weight decay = 9e-07, hidden layer size = 288
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:00<00:00, 103.64it/s] 
 random trial 31: val acc = 0.98025
---- Random Trial 32 --------------------------------------------------------------
 lr = 0.24175, weight decay = 5.36e-05, hidden layer size = 274
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:57<00:00, 105.70it/s] 
 random trial 32: val acc = 0.981167
---- Random Trial 33 --------------------------------------------------------------
 lr = 0.247522, weight decay = 3e-07, hidden layer size = 292
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:02<00:00, 103.01it/s] 
 random trial 33: val acc = 0.98125
---- Random Trial 34 --------------------------------------------------------------
 lr = 0.203216, weight decay = 5.25e-05, hidden layer size = 219
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:41<00:00, 116.00it/s] 
 random trial 34: val acc = 0.9795
---- Random Trial 35 --------------------------------------------------------------
 lr = 0.196856, weight decay = 1e-07, hidden layer size = 274
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:57<00:00, 105.54it/s] 
 random trial 35: val acc = 0.97875
---- Random Trial 36 --------------------------------------------------------------
 lr = 0.232556, weight decay = 1.27e-05, hidden layer size = 267
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:55<00:00, 106.96it/s] 
 random trial 36: val acc = 0.981167
---- Random Trial 37 --------------------------------------------------------------
 lr = 0.178941, weight decay = 4e-07, hidden layer size = 225
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:45<00:00, 113.21it/s] 
 random trial 37: val acc = 0.978417
---- Random Trial 38 --------------------------------------------------------------
 lr = 0.181655, weight decay = 2.31e-05, hidden layer size = 283
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:00<00:00, 103.61it/s] 
 random trial 38: val acc = 0.979333
---- Random Trial 39 --------------------------------------------------------------
 lr = 0.164509, weight decay = 1e-06, hidden layer size = 200
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:35<00:00, 120.24it/s] 
 random trial 39: val acc = 0.979417
---- Random Trial 40 --------------------------------------------------------------
 lr = 0.186752, weight decay = 3.8e-06, hidden layer size = 210
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:39<00:00, 117.21it/s] 
 random trial 40: val acc = 0.97875
---- Random Trial 41 --------------------------------------------------------------
 lr = 0.159192, weight decay = 7.02e-05, hidden layer size = 201
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:35<00:00, 120.27it/s] 
 random trial 41: val acc = 0.978833
---- Random Trial 42 --------------------------------------------------------------
 lr = 0.213718, weight decay = 1.9e-06, hidden layer size = 298
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:05<00:00, 101.29it/s] 
 random trial 42: val acc = 0.979917
---- Random Trial 43 --------------------------------------------------------------
 lr = 0.150679, weight decay = 6.2e-06, hidden layer size = 259
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:53<00:00, 108.33it/s] 
 random trial 43: val acc = 0.978583
---- Random Trial 44 --------------------------------------------------------------
 lr = 0.185766, weight decay = 5e-06, hidden layer size = 276
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:58<00:00, 104.99it/s] 
 random trial 44: val acc = 0.979417
---- Random Trial 45 --------------------------------------------------------------
 lr = 0.156674, weight decay = 3e-07, hidden layer size = 203
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:36<00:00, 119.94it/s] 
 random trial 45: val acc = 0.97875
---- Random Trial 46 --------------------------------------------------------------
 lr = 0.192076, weight decay = 2.13e-05, hidden layer size = 266
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:54<00:00, 107.17it/s] 
 random trial 46: val acc = 0.979417
---- Random Trial 47 --------------------------------------------------------------
 lr = 0.226272, weight decay = 5e-07, hidden layer size = 265
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:55<00:00, 107.06it/s] 
 random trial 47: val acc = 0.979
---- Random Trial 48 --------------------------------------------------------------
 lr = 0.183796, weight decay = 1.11e-05, hidden layer size = 272
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [02:59<00:00, 104.63it/s] 
 random trial 48: val acc = 0.977833
---- Random Trial 49 --------------------------------------------------------------
 lr = 0.173993, weight decay = 1.3e-06, hidden layer size = 251
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:01<00:00, 103.07it/s] 
 random trial 49: val acc = 0.977583
---- Random Trial 50 --------------------------------------------------------------
 lr = 0.217143, weight decay = 1e-07, hidden layer size = 277
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18750/18750 [03:08<00:00, 99.52it/s] 
 random trial 50: val acc = 0.97925

==== Hyper-Parameters Ranking List ===============================================
          lr  weight decay  hidden size   val acc
0   0.247522  2.546591e-07        292.0  0.981250
1   0.232556  1.274584e-05        267.0  0.981167
2   0.241750  5.361182e-05        274.0  0.981167
3   0.223281  1.540339e-06        252.0  0.980917
4   0.232170  4.930550e-05        282.0  0.980833
5   0.185076  9.307791e-07        261.0  0.980833
6   0.231094  8.679479e-07        288.0  0.980250
7   0.224610  8.636323e-05        203.0  0.980083
8   0.191134  1.141319e-05        272.0  0.980000
9   0.213718  1.855635e-06        298.0  0.979917
10  0.239926  3.702868e-05        247.0  0.979833
11  0.183816  2.884889e-07        282.0  0.979833
12  0.220810  1.068386e-05        288.0  0.979750
13  0.197776  3.597379e-06        267.0  0.979667
14  0.210843  4.682391e-07        266.0  0.979583
15  0.203216  5.254191e-05        219.0  0.979500
16  0.194193  3.030606e-05        293.0  0.979417
17  0.192076  2.126012e-05        266.0  0.979417
18  0.164509  1.038358e-06        200.0  0.979417
19  0.185766  5.010409e-06        276.0  0.979417
20  0.181655  2.306371e-05        283.0  0.979333
21  0.243132  6.910459e-07        210.0  0.979333
22  0.205195  2.840934e-06        290.0  0.979333
23  0.211917  2.801741e-06        257.0  0.979333
24  0.217143  1.270241e-07        277.0  0.979250
25  0.210362  2.360054e-06        250.0  0.979250
26  0.207795  4.011006e-05        242.0  0.979083
27  0.226272  5.348861e-07        265.0  0.979000
28  0.162185  1.574980e-07        287.0  0.978917
29  0.216186  2.582838e-07        244.0  0.978833
30  0.159192  7.017950e-05        201.0  0.978833
31  0.235109  2.616225e-07        252.0  0.978833
32  0.214409  2.112042e-07        254.0  0.978750
33  0.156674  2.749102e-07        203.0  0.978750
34  0.196856  1.073752e-07        274.0  0.978750
35  0.186752  3.807173e-06        210.0  0.978750
36  0.150679  6.150482e-06        259.0  0.978583
37  0.155615  5.670217e-07        234.0  0.978583
38  0.172213  4.672741e-07        210.0  0.978500
39  0.178941  3.526839e-07        225.0  0.978417
40  0.184756  2.160711e-07        274.0  0.978333
41  0.154512  7.146735e-07        256.0  0.978333
42  0.173825  8.462361e-06        226.0  0.978250
43  0.227342  7.377783e-06        271.0  0.978167
44  0.157534  1.400435e-07        236.0  0.978083
45  0.186649  2.340395e-07        207.0  0.978000
46  0.155050  7.218086e-06        208.0  0.977917
47  0.183796  1.112397e-05        272.0  0.977833
48  0.173993  1.255089e-06        251.0  0.977583
49  0.165680  8.232294e-07        219.0  0.977250
==== Training with the Optimal Hyper Parameters ==================================
 epoch 50, train_acc 1.0000, test_acc 0.9813: 100%|██████████████████████████████████████████████████████████████████| 23400/23400 [04:49<00:00, 80.92it/s] 
==== Final Test Accuracy =========================================================
 test acc: 0.9808

 The netowrk has been saved in trainer.pkl!

 The netowrk has been saved in network.pkl!

---- Train and Test Loss and Accuracy per Epoch ----------------------------------
    epoch  train loss  test loss  train acc  test acc
0     2.0    0.199052   0.198884   0.942317    0.9421
1     3.0    0.137647   0.140174   0.960517    0.9577
2     4.0    0.101516   0.114631   0.971667    0.9649
3     5.0    0.081714   0.098276   0.977233    0.9696
4     6.0    0.068581   0.085991   0.981317    0.9733
5     7.0    0.059493   0.084815   0.984267    0.9745
6     8.0    0.049437   0.075331   0.986950    0.9773
7     9.0    0.043423   0.075726   0.989083    0.9779
8    10.0    0.038348   0.071498   0.990667    0.9781
9    11.0    0.036063   0.072585   0.991150    0.9781
10   12.0    0.031780   0.069703   0.992450    0.9785
11   13.0    0.028241   0.067092   0.993800    0.9795
12   14.0    0.025232   0.066920   0.994483    0.9790
13   15.0    0.022284   0.068751   0.995733    0.9799
14   16.0    0.020653   0.067130   0.995800    0.9794
15   17.0    0.018674   0.065407   0.996500    0.9802
16   18.0    0.016482   0.065147   0.997200    0.9801
17   19.0    0.015631   0.065764   0.997533    0.9798
18   20.0    0.014344   0.066117   0.997950    0.9798
19   21.0    0.013542   0.065509   0.998083    0.9792
20   22.0    0.011829   0.065613   0.998350    0.9809
21   23.0    0.011351   0.065402   0.998517    0.9808
22   24.0    0.009789   0.065246   0.998833    0.9809
23   25.0    0.009431   0.064990   0.999000    0.9801
24   26.0    0.008352   0.064577   0.999233    0.9810
25   27.0    0.007660   0.064444   0.999333    0.9804
26   28.0    0.007242   0.066617   0.999450    0.9802
27   29.0    0.007033   0.065005   0.999417    0.9816
28   30.0    0.006144   0.065647   0.999717    0.9814
29   31.0    0.005870   0.064012   0.999617    0.9812
30   32.0    0.005660   0.066929   0.999683    0.9808
31   33.0    0.005541   0.065871   0.999733    0.9810
32   34.0    0.005073   0.065621   0.999683    0.9805
33   35.0    0.004820   0.065976   0.999833    0.9804
34   36.0    0.004655   0.066474   0.999900    0.9817
35   37.0    0.004308   0.066605   0.999900    0.9810
36   38.0    0.004102   0.066958   0.999850    0.9813
37   39.0    0.003919   0.068041   0.999933    0.9807
38   40.0    0.003927   0.068473   0.999950    0.9819
39   41.0    0.003695   0.067768   0.999967    0.9802
40   42.0    0.003457   0.066857   0.999967    0.9811
41   43.0    0.003369   0.068193   0.999950    0.9809
42   44.0    0.003192   0.067853   0.999983    0.9811
43   45.0    0.003053   0.067649   0.999967    0.9811
44   46.0    0.002999   0.067961   0.999983    0.9809
45   47.0    0.002839   0.068110   0.999983    0.9808
46   48.0    0.002740   0.068823   0.999983    0.9807
47   49.0    0.002728   0.068393   0.999983    0.9806
48   50.0    0.002565   0.069507   1.000000    0.9813

==== END =========================================================================
PS D:\documents\2023spring\nndl\two_layer_neural_network> & C:/Python311/python.exe d:/documents/2023spring/nndl/two_layer_neural_network/test.py
==== Test ========================================================================
 train_acc: 1.0
 test_acc: 0.9808